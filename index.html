<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>로또 번호 분석기</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>🎰 로또 번호 분석기</h1>
            <p>최근 1년간 로또 데이터를 분석하여 번호를 추천합니다</p>
        </header>

        <div class="controls">
            <button id="analyzeBtn" class="btn-primary">📊 데이터 분석 시작</button>
            <button id="generateBtn" class="btn-secondary" disabled>🎲 번호 생성</button>
            <div class="loading" id="loading" style="display: none;">
                <div class="spinner"></div>
                <span>데이터 분석 중...</span>
            </div>
        </div>

        <div class="status" id="status"></div>

        <div class="tabs">
            <button class="tab-btn active" data-tab="analysis">📈 분석 결과</button>
            <button class="tab-btn" data-tab="hot-numbers">🔥 자주 나온 번호</button>
            <button class="tab-btn" data-tab="cold-numbers">❄️ 적게 나온 번호</button>
            <button class="tab-btn" data-tab="recommended">🎯 AI 추천</button>
        </div>

        <div class="tab-content">
            <!-- 분석 결과 탭 -->
            <div id="analysis" class="tab-panel active">
                <div class="analysis-grid">
                    <div class="card">
                        <h3>📊 번호별 출현 빈도</h3>
                        <canvas id="frequencyChart"></canvas>
                    </div>
                    <div class="card">
                        <h3>🔢 홀짝 분포</h3>
                        <canvas id="oddEvenChart"></canvas>
                    </div>
                    <div class="card">
                        <h3>📍 구간별 분포</h3>
                        <canvas id="rangeChart"></canvas>
                    </div>
                    <div class="card">
                        <h3>📈 합계 분포</h3>
                        <canvas id="sumChart"></canvas>
                    </div>
                </div>
                
                <div class="stats-summary" id="statsSummary">
                    <!-- 통계 요약이 여기에 표시됩니다 -->
                </div>
            </div>

            <!-- 자주 나온 번호 탭 -->
            <div id="hot-numbers" class="tab-panel">
                <div class="card">
                    <h3>🔥 자주 나온 번호 TOP 15</h3>
                    <div id="hotNumbersList" class="number-list">
                        <!-- 자주 나온 번호 목록 -->
                    </div>
                </div>
                
                <div class="card">
                    <h3>🔥 자주 나온 번호 기반 추천</h3>
                    <div id="hotRecommendations" class="lotto-sets">
                        <!-- 추천 번호 세트들 -->
                    </div>
                </div>
            </div>

            <!-- 적게 나온 번호 탭 -->
            <div id="cold-numbers" class="tab-panel">
                <div class="card">
                    <h3>❄️ 적게 나온 번호 TOP 15</h3>
                    <div id="coldNumbersList" class="number-list">
                        <!-- 적게 나온 번호 목록 -->
                    </div>
                </div>
                
                <div class="card">
                    <h3>❄️ 적게 나온 번호 기반 추천</h3>
                    <div id="coldRecommendations" class="lotto-sets">
                        <!-- 추천 번호 세트들 -->
                    </div>
                </div>
            </div>

            <!-- AI 추천 탭 -->
            <div id="recommended" class="tab-panel">
                <div class="card">
                    <h3>🎯 AI 종합 분석 추천 번호</h3>
                    <p class="description">빈도, 구간 균형, 홀짝 균형을 종합적으로 고려한 추천 번호입니다.</p>
                                      // ...existing code...
                    
                    // 최신 회차 번호 가져오기 (예시: 903회 이후 최신 회차 자동 탐색)
                    async function getLatestDrawNo() {
                        let drawNo = 1100; // 대략 최신 회차 예상값
                        while (drawNo > 0) {
                            const res = await fetch(`https://www.dhlottery.co.kr/common.do?method=getLottoNumber&drwNo=${drawNo}`);
                            const data = await res.json();
                            if (data.returnValue === "success") return drawNo;
                            drawNo--;
                        }
                        return null;
                    }
                    
                    // 특정 회차의 당첨번호 가져오기
                    async function fetchLottoNumbers(drawNo) {
                        const res = await fetch(`https://www.dhlottery.co.kr/common.do?method=getLottoNumber&drwNo=${drawNo}`);
                        const data = await res.json();
                        if (data.returnValue !== "success") return null;
                        // 1~6번 + 보너스 번호
                        return [
                            data.drwtNo1, data.drwtNo2, data.drwtNo3,
                            data.drwtNo4, data.drwtNo5, data.drwtNo6,
                            data.bnusNo
                        ];
                    }
                    
                    // 최근 1년(약 52주)간 당첨번호 데이터 수집
                    async function fetchRecentLottoData() {
                        const latest = await getLatestDrawNo();
                        const results = [];
                        for (let i = 0; i < 52; i++) {
                            const nums = await fetchLottoNumbers(latest - i);
                            if (nums) results.push(nums);
                        }
                        return results;
                    }
                    
                    // 분석 버튼 클릭 시 API로 데이터 수집
                    document.getElementById('analyzeBtn').addEventListener('click', async () => {
                        document.getElementById('loading').style.display = 'flex';
                        const lottoData = await fetchRecentLottoData();
                        document.getElementById('loading').style.display = 'none';
                        // lottoData: [[1,2,3,4,5,6,7], ...] 형태
                        // 여기서 분석/차트/추천 로직 호출
                        analyzeLottoData(lottoData);
                        document.getElementById('generateBtn').disabled = false;
                    });
                    
                    // 분석/추천 함수 예시 (lottoData를 활용)
                    function analyzeLottoData(lottoData) {
                        // 번호 빈도, 홀짝, 구간, 합계 등 분석
                        // Chart.js로 시각화, 추천번호 생성 등
                        // ...여기에 기존 분석/추천 코드 연결...
                    }
                    
                    // ...existing code...  <div id="aiRecommendations" class="lotto-sets">
                        <!-- AI 추천 번호 세트들 -->
                    </div>
                </div>

                <div class="card">
                    <h3>⚖️ 균형잡힌 전략 번호</h3>
                    <p class="description">각 구간(1-15, 16-30, 31-45)에서 균등하게 선택한 번호입니다.</p>
                    <div id="balancedRecommendations" class="lotto-sets">
                        <!-- 균형잡힌 번호 세트들 -->
                    </div>
                </div>
            </div>
        </div>

        <footer>
            <div class="warning">
                <h4>⚠️ 중요 안내사항</h4>
                <ul>
                    <li>로또는 완전한 확률게임입니다</li>
                    <li>과거 데이터 분석이 미래 당첨을 보장하지 않습니다</li>
                    <li>이 분석은 통계적 참고용으로만 활용하세요</li>
                    <li>책임감 있는 게임 참여를 권장합니다</li>
                </ul>
            </div>
        </footer>
    </div>

    <script src="script.js"></script>
</body>
</html>
